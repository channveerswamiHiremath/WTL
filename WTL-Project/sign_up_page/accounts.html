<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bank Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', sans-serif;
    }

    body {
      display: flex;
      height: 100vh;
      background: #f9f9f9;
      color: #111;
    }

    .sidebar {
      width: 250px;
      background: #fff;
      border-right: 1px solid #e0e0e0;
      padding: 20px;
    }

    .user-profile {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 30px;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 16px;
      color: white;
      text-align: center;
    }

    .user-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      border: 4px solid rgba(255, 255, 255, 0.3);
      margin-bottom: 15px;
      object-fit: cover;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .user-info h2 {
      font-size: 18px;
      margin-bottom: 5px;
      font-weight: 600;
    }

    .user-info .user-email {
      font-size: 12px;
      opacity: 0.8;
      margin-bottom: 10px;
    }

    .user-status {
      background: rgba(255, 255, 255, 0.2);
      padding: 5px 12px;
      border-radius: 15px;
      font-size: 11px;
      font-weight: 500;
    }

    .sidebar a {
      display: flex;
      align-items: center;
      padding: 12px 10px;
      text-decoration: none;
      color: #333;
      border-radius: 8px;
      margin-bottom: 10px;
      transition: 0.2s;
    }

    .sidebar a:hover, .sidebar a.active {
      background-color: #f0f0f0;
    }

    .sidebar a i {
      margin-right: 10px;
    }

    .go-back {
      margin-top: 60px;
      display: flex;
      align-items: center;
      color: #888;
      font-size: 14px;
    }

    .main {
      flex-grow: 1;
      padding: 40px;
      overflow-y: auto;
    }

    .main-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }

    .main h1 {
      font-size: 28px;
    }

    .header-user-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .header-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid #e0e0e0;
    }

    .header-user-details h3 {
      font-size: 16px;
      margin-bottom: 2px;
    }

    .header-user-details .user-id {
      font-size: 12px;
      color: #666;
    }

    .card {
      background: linear-gradient(135deg, #f6e8dd 0%, #f0d5b8 100%);
      padding: 30px;
      border-radius: 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .card .amount {
      text-align: right;
    }

    .amount h2 {
      font-size: 24px;
    }

    .amount span {
      color: #777;
      font-size: 14px;
    }

    .transactions {
      margin-bottom: 30px;
    }

    .transactions h2 {
      font-size: 20px;
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .refresh-btn {
      background: #4a90e2;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
    }

    .refresh-btn:hover {
      background: #357ab7;
    }

    .transaction {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 0;
      border-bottom: 1px solid #eee;
      animation: slideIn 0.3s ease-in-out;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .transaction.new {
      background-color: #e8f5e8;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 10px;
      border: 2px solid #4caf50;
    }

    .transaction .left {
      display: flex;
      align-items: center;
    }

    .icon-box {
      width: 40px;
      height: 40px;
      background: #eee;
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: 8px;
      margin-right: 15px;
      font-size: 18px;
    }

    .icon-box.sent {
      background: #ffebee;
      color: #e53935;
    }

    .icon-box.received {
      background: #e8f5e8;
      color: #4caf50;
    }

    .details {
      display: flex;
      flex-direction: column;
    }

    .details strong {
      font-size: 16px;
    }

    .details small {
      color: #888;
      font-size: 13px;
    }

    .transaction-amount {
      font-weight: bold;
    }

    .transaction-amount.positive {
      color: #4caf50;
    }

    .transaction-amount.negative {
      color: #e53935;
    }

    .logout-btn {
      background: #ff4757;
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 20px;
      width: 100%;
    }

    .logout-btn:hover {
      background: #ff3838;
    }

    .no-user {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      flex-direction: column;
      color: #666;
    }

    .quick-actions {
      display: flex;
      gap: 15px;
      margin-bottom: 30px;
    }

    .quick-action-btn {
      background: #4a90e2;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
      font-size: 14px;
    }

    .quick-action-btn:hover {
      background: #357ab7;
    }

    .filter-tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .filter-tab {
      padding: 8px 16px;
      border: 1px solid #ddd;
      background: white;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
    }

    .filter-tab.active {
      background: #4a90e2;
      color: white;
      border-color: #4a90e2;
    }

    .empty-state {
      text-align: center;
      color: #888;
      padding: 40px;
      font-style: italic;
    }

    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #4caf50;
      color: white;
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      z-index: 1000;
      opacity: 0;
      transform: translateX(100%);
      transition: all 0.3s ease;
    }

    .notification.show {
      opacity: 1;
      transform: translateX(0);
    }
  </style>
</head>
<body>
  <div id="no-user-message" class="no-user" style="display: none;">
    <h2>Please log in to access your account</h2>
    <a href="login.html" style="margin-top: 20px; padding: 10px 20px; background: #4a90e2; color: white; text-decoration: none; border-radius: 5px;">Go to Login</a>
  </div>

  <div id="dashboard-content" style="display: flex; width: 100%;">
    <div class="sidebar">
      <div class="user-profile">
        <img id="sidebar-avatar" src="https://i.pravatar.cc/150" alt="User Avatar" class="user-avatar" />
        <div class="user-info">
          <h2 id="username-display">Welcome</h2>
          <div class="user-email" id="user-email">user@example.com</div>
          <div class="user-status">Premium Member</div>
        </div>
      </div>
      
      <a href="index.html"><i></i> Home</a>
      <a href="pay.html" class="active"><i></i> Make transaction</a>
      <button class="logout-btn" onclick="logout()">Logout</button>
    </div>

    <div class="main">
      <div class="main-header">
        <h1>Overview</h1>
        <div class="header-user-info">
          <img id="header-avatar" src="https://i.pravatar.cc/150" alt="User" class="header-avatar" />
          <div class="header-user-details">
            <h3 id="header-username">User Name</h3>
            <div class="user-id" id="user-account-id">Account #12345</div>
          </div>
        </div>
      </div>
      
      <div class="card">
        <div class="card-img">
          <img src="\image\Radha_rani.jpg" alt="card" style="height: 160px; border-radius: 12px;" />
        </div>
        <div class="amount">
          <h2 id="balance-display">0.00</h2>
          <span>Checking account<br />Available balance</span>
        </div>
      </div>

      <div class="quick-actions">
        <a href="pay.html" class="quick-action-btn">Send Money</a>
        <button class="quick-action-btn" onclick="requestMoney()">Request Money</button>
        <button class="quick-action-btn" onclick="addMoney()">Add Money</button>
      </div>

      <div class="transactions">
        <h2>
          Recent transactions
          <button class="refresh-btn" onclick="refreshTransactions()">Refresh</button>
        </h2>

        <div class="filter-tabs">
          <div class="filter-tab active" onclick="filterTransactions('all')">All</div>
          <div class="filter-tab" onclick="filterTransactions('sent')">Sent</div>
          <div class="filter-tab" onclick="filterTransactions('received')">Received</div>
          <div class="filter-tab" onclick="filterTransactions('today')">Today</div>
        </div>

        <div id="transactions-container">
          <div class="empty-state" id="empty-state">
            No transactions yet. Make your first transaction!
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="watermark" style="
  position: fixed;
  top: 50%;
  left: 40%;
  font-size: 60px;
  color: rgba(200, 200, 200, 0.3);
  transform: fixed();
  pointer-events: none;
  z-index: 9999;
">
  Confidential information
</div>


  <div id="notification" class="notification"></div>

  <script>
    let currentFilter = 'all';
    let transactionCheckInterval;

    // Generate user avatar based on email/username
    function generateUserAvatar(user) {
      // Try to get saved avatar first
      if (user.avatar) {
        return user.avatar;
      }
      
      // Generate based on user info
      const seed = user.email || user.username || 'default';
      const avatarStyles = [
        `https://i.pravatar.cc/150?u=${encodeURIComponent(seed)}`,
        `https://ui-avatars.com/api/?name=${encodeURIComponent(user.username || user.email.split('@')[0])}&size=150&background=667eea&color=fff&bold=true`,
        `https://robohash.org/${encodeURIComponent(seed)}?set=set4&size=150x150`,
        `https://avatars.dicebear.com/api/bottts/${encodeURIComponent(seed)}.svg`
      ];
      
      // Choose avatar style based on user preference or random
      const avatarIndex = user.avatarStyle || Math.abs(seed.split('').reduce((a, b) => a + b.charCodeAt(0), 0)) % avatarStyles.length;
      return avatarStyles[avatarIndex];
    }

    // Generate account ID
    function generateAccountId(user) {
      if (user.accountId) {
        return user.accountId;
      }
      
      // Generate based on email hash
      const hash = user.email.split('').reduce((a, b) => a + b.charCodeAt(0), 0);
      return `ACC${String(hash).padStart(6, '0').slice(-6)}`;
    }

    // Check if user is logged in and load their data
    function loadUserData() {
      const currentUser = JSON.parse(localStorage.getItem('currentUser'));
      
      if (!currentUser) {
        document.getElementById('dashboard-content').style.display = 'none';
        document.getElementById('no-user-message').style.display = 'flex';
        return;
      }

      // Generate and save avatar if not exists
      if (!currentUser.avatar) {
        currentUser.avatar = generateUserAvatar(currentUser);
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        
        // Also update in users array
        const users = JSON.parse(localStorage.getItem('users')) || [];
        const userIndex = users.findIndex(u => u.email === currentUser.email);
        if (userIndex !== -1) {
          users[userIndex].avatar = currentUser.avatar;
          localStorage.setItem('users', JSON.stringify(users));
        }
      }

      // Generate and save account ID if not exists
      if (!currentUser.accountId) {
        currentUser.accountId = generateAccountId(currentUser);
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        
        // Also update in users array
        const users = JSON.parse(localStorage.getItem('users')) || [];
        const userIndex = users.findIndex(u => u.email === currentUser.email);
        if (userIndex !== -1) {
          users[userIndex].accountId = currentUser.accountId;
          localStorage.setItem('users', JSON.stringify(users));
        }
      }

      // User is logged in, display their information
      const displayName = currentUser.fullName || currentUser.username || currentUser.email.split('@')[0];
      
      document.getElementById('username-display').textContent = displayName;
      document.getElementById('header-username').textContent = displayName;
      document.getElementById('user-email').textContent = currentUser.email;
      document.getElementById('user-account-id').textContent = `Account #${currentUser.accountId}`;
      
      // Set user avatars
      const avatarUrl = currentUser.avatar;
      document.getElementById('sidebar-avatar').src = avatarUrl;
      document.getElementById('header-avatar').src = avatarUrl;
      
      // Handle avatar loading errors
      document.getElementById('sidebar-avatar').onerror = function() {
        this.src = `https://ui-avatars.com/api/?name=${encodeURIComponent(displayName)}&size=150&background=667eea&color=fff&bold=true`;
      };
      
      document.getElementById('header-avatar').onerror = function() {
        this.src = `https://ui-avatars.com/api/?name=${encodeURIComponent(displayName)}&size=150&background=667eea&color=fff&bold=true`;
      };
      
      // Set default balance if not exists
      let balance = currentUser.balance !== undefined ? currentUser.balance : 2345.67;
      
      // Update user balance in localStorage if it was default
      if (currentUser.balance === undefined) {
        currentUser.balance = balance;
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        
        // Also update in users array
        const users = JSON.parse(localStorage.getItem('users')) || [];
        const userIndex = users.findIndex(u => u.email === currentUser.email);
        if (userIndex !== -1) {
          users[userIndex].balance = balance;
          localStorage.setItem('users', JSON.stringify(users));
        }
      }
      
      document.getElementById('balance-display').textContent = `$${balance.toFixed(2)}`;
      
      // Show dashboard
      document.getElementById('dashboard-content').style.display = 'flex';
      document.getElementById('no-user-message').style.display = 'none';
      
      // Load transactions
      loadTransactions();
      
      // Start checking for new transactions every 2 seconds
      startTransactionMonitoring();
    }

    // Start monitoring for new transactions
    function startTransactionMonitoring() {
      transactionCheckInterval = setInterval(() => {
        checkForNewTransactions();
      }, 2000);
    }

    // Check for new transactions
    function checkForNewTransactions() {
      const currentUser = JSON.parse(localStorage.getItem('currentUser'));
      if (!currentUser) return;

      const storedTransactions = JSON.parse(localStorage.getItem(`transactions_${currentUser.email}`)) || [];
      const displayedTransactions = document.querySelectorAll('.transaction:not(.new)').length;
      
      if (storedTransactions.length > displayedTransactions) {
        loadTransactions();
        showNotification('New transaction detected!');
      }
    }

    // Load and display transactions
    function loadTransactions() {
      const currentUser = JSON.parse(localStorage.getItem('currentUser'));
      if (!currentUser) return;

      const transactions = JSON.parse(localStorage.getItem(`transactions_${currentUser.email}`)) || [];
      const container = document.getElementById('transactions-container');
      const emptyState = document.getElementById('empty-state');
      
      if (transactions.length === 0) {
        emptyState.style.display = 'block';
        return;
      }
      
      emptyState.style.display = 'none';
      
      // Sort transactions by date (newest first)
      transactions.sort((a, b) => new Date(b.date) - new Date(a.date));
      
      // Filter transactions based on current filter
      const filteredTransactions = filterTransactionsByType(transactions, currentFilter);
      
      container.innerHTML = '';
      
      filteredTransactions.forEach((transaction, index) => {
        const transactionElement = createTransactionElement(transaction);
        if (index === 0 && isRecentTransaction(transaction)) {
          transactionElement.classList.add('new');
          setTimeout(() => {
            transactionElement.classList.remove('new');
          }, 3000);
        }
        container.appendChild(transactionElement);
      });
    }

    // Create transaction element
    function createTransactionElement(transaction) {
      const div = document.createElement('div');
      div.className = 'transaction';
      
      const isPositive = transaction.type === 'received' || transaction.type === 'deposit';
      const icon = getTransactionIcon(transaction.type);
      const iconClass = isPositive ? 'received' : 'sent';
      
      div.innerHTML = `
        <div class="left">
          <div class="icon-box ${iconClass}">
            ${icon}
          </div>
          <div class="details">
            <strong>${transaction.description}</strong>
            <small>${transaction.category} ‚Ä¢ ${formatDate(transaction.date)}</small>
          </div>
        </div>
        <div class="transaction-amount ${isPositive ? 'positive' : 'negative'}">
          ${isPositive ? '+' : '-'}$${Math.abs(transaction.amount).toFixed(2)}
        </div>
      `;
      
      return div;
    }

    // Get transaction icon
    function getTransactionIcon(type) {
      const icons = {
        'sent': 'üì§',
        'received': 'üì•',
        'deposit': 'üí∞',
        'withdrawal': 'üèß',
        'purchase': 'üõí',
        'transfer': 'üîÑ'
      };
      return icons[type] || 'üí≥';
    }

    // Format date
    function formatDate(dateString) {
      const date = new Date(dateString);
      const now = new Date();
      const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
      const transactionDate = new Date(date.getFullYear(), date.getMonth(), date.getDate());
      
      if (transactionDate.getTime() === today.getTime()) {
        return `Today ${date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}`;
      } else if (transactionDate.getTime() === today.getTime() - 24*60*60*1000) {
        return `Yesterday ${date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}`;
      } else {
        return date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
      }
    }

    // Check if transaction is recent (within last 5 minutes)
    function isRecentTransaction(transaction) {
      const transactionTime = new Date(transaction.date);
      const now = new Date();
      return (now - transactionTime) < 5 * 60 * 1000; // 5 minutes
    }

    // Filter transactions by type
    function filterTransactionsByType(transactions, filter) {
      const today = new Date();
      today.setHours(0, 0, 0, 0);
      
      switch(filter) {
        case 'sent':
          return transactions.filter(t => t.type === 'sent' || t.type === 'withdrawal' || t.type === 'purchase');
        case 'received':
          return transactions.filter(t => t.type === 'received' || t.type === 'deposit');
        case 'today':
          return transactions.filter(t => new Date(t.date) >= today);
        default:
          return transactions;
      }
    }

    // Filter transactions
    function filterTransactions(filter) {
      currentFilter = filter;
      
      // Update active tab
      document.querySelectorAll('.filter-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      event.target.classList.add('active');
      
      loadTransactions();
    }

    // Add sample transaction (for testing)
    function addSampleTransaction(type = 'sent', amount = 50, description = 'Test Transaction') {
      const currentUser = JSON.parse(localStorage.getItem('currentUser'));
      if (!currentUser) return;

      const transactions = JSON.parse(localStorage.getItem(`transactions_${currentUser.email}`)) || [];
      
      const newTransaction = {
        id: Date.now().toString(),
        type: type,
        amount: amount,
        description: description,
        category: type === 'sent' ? 'Transfer' : 'Deposit',
        date: new Date().toISOString(),
        recipient: type === 'sent' ? 'John Doe' : 'Salary Deposit'
      };
      
      transactions.push(newTransaction);
      localStorage.setItem(`transactions_${currentUser.email}`, JSON.stringify(transactions));
      
      // Update balance
      if (type === 'sent' || type === 'withdrawal' || type === 'purchase') {
        currentUser.balance -= amount;
      } else {
        currentUser.balance += amount;
      }
      
      localStorage.setItem('currentUser', JSON.stringify(currentUser));
      
      // Update balance display
      document.getElementById('balance-display').textContent = `$${currentUser.balance.toFixed(2)}`;
      
      // Refresh transactions
      loadTransactions();
      
      showNotification(`${type === 'sent' ? 'Sent' : 'Received'} $${amount.toFixed(2)}`);
    }

    // Quick action functions
    function requestMoney() {
      const amount = prompt('Enter amount to request:');
      if (amount && !isNaN(amount) && amount > 0) {
        addSampleTransaction('received', parseFloat(amount), 'Money Request Fulfilled');
      }
    }

    function addMoney() {
      const amount = prompt('Enter amount to add:');
      if (amount && !isNaN(amount) && amount > 0) {
        addSampleTransaction('deposit', parseFloat(amount), 'Account Deposit');
      }
    }

    // Refresh transactions
    function refreshTransactions() {
      showNotification('Refreshing transactions...');
      setTimeout(() => {
        loadTransactions();
        showNotification('Transactions updated!');
      }, 1000);
    }

    // Show notification
    function showNotification(message) {
      const notification = document.getElementById('notification');
      notification.textContent = message;
      notification.classList.add('show');
      
      setTimeout(() => {
        notification.classList.remove('show');
      }, 3000);
    }

    // Logout function
    function logout() {
      if (transactionCheckInterval) {
        clearInterval(transactionCheckInterval);
      }
      localStorage.removeItem('currentUser');
      alert('Logged out successfully!');
      window.location.href = 'login.html';
    }

    // Listen for transaction events from other pages
    window.addEventListener('storage', function(e) {
      if (e.key && e.key.startsWith('transactions_')) {
        loadTransactions();
      }
    });

    // Load user data when page loads
    document.addEventListener('DOMContentLoaded', loadUserData);

    // Cleanup on page unload
    window.addEventListener('beforeunload', function() {
      if (transactionCheckInterval) {
        clearInterval(transactionCheckInterval);
      }
    });
    document.addEventListener('keyup', (e) => {
    if (e.key === 'PrintScreen') {
      document.body.classList.add('blurred');
      alert("Screenshot attempt detected. Data blurred!");

      // Optional: auto-remove blur after 5 seconds
      setTimeout(() => {
        document.body.classList.remove('blurred');
      }, 5000);
    }
  });
</script>


</body>
</html>